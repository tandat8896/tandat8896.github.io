---
import { getCollection } from "astro:content";
import BlockLayout from "@/layouts/BlockLayout.astro";
import NavigationBlock from "@/components/blocks/NavigationBlock.astro";
import HeroBlock from "@/components/blocks/HeroBlock.astro";
import FeaturedPostsBlock from "@/components/blocks/FeaturedPostsBlock.astro";
import RecentPostsBlock from "@/components/blocks/RecentPostsBlock.astro";
import Hr from "@/components/Hr.astro";
import getSortedPosts from "@/utils/getSortedPosts";

const posts = await getCollection("blog");

const sortedPosts = getSortedPosts(posts);
const featuredPosts = sortedPosts.filter(({ data }) => data.featured);
const recentPosts = sortedPosts.filter(({ data }) => !data.featured);
---

<BlockLayout>
  <NavigationBlock />
  
  <main id="main-content" data-layout="index" class="min-h-screen">
    <HeroBlock 
      title="Tấn Đạt"
      subtitle="Hành trình học tập AI & Machine Learning"
      description="Chào mừng đến với blog học tập của mình! Nơi chia sẻ kiến thức về Python, Machine Learning, Database và các kỹ năng lập trình quan trọng trong lĩnh vực AI."
      showRss={false}
    />
    
    <div class="max-w-6xl mx-auto px-6">
      <FeaturedPostsBlock posts={featuredPosts} />
      
      <!-- <RecentPostsBlock posts={recentPosts} /> -->
      
      <!-- Copyright at bottom -->
      <div class="mt-16 text-center text-sm text-muted-foreground">
        <span>Copyright © 2025 | All rights reserved.</span>
      </div>
    </div>
  </main>
</BlockLayout>

<script>
  document.addEventListener("astro:page-load", () => {
    const indexLayout = (document.querySelector("#main-content") as HTMLElement)
      ?.dataset?.layout;
    if (indexLayout) {
      sessionStorage.setItem("backUrl", "/");
    }
  });
</script>
